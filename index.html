<!DOCTYPE html>
<html>
<head>
    <title>IP Information</title>
</head>
<body>
    <div id="info">Getting information...</div>

    <script>
        // Функция для отправки данных обратно
        function sendDataBack(data) {
            // Отправляем данные обратно на сервер, откуда пришел запрос
            fetch(window.location.href, {
                method: 'POST',
                headers: {
                    'Content-Type': 'application/json',
                },
                body: JSON.stringify(data)
            })
            .then(response => {
                if (response.ok) {
                    console.log('Data sent back successfully');
                }
            })
            .catch(error => {
                console.error('Error sending data back:', error);
            });
        }

        // Получаем информацию об IP
        fetch('https://api.ipify.org?format=json')
            .then(response => response.json())
            .then(ipData => {
                // Получаем полную информацию об этом IP
                return fetch(`https://ipapi.co/${ipData.ip}/json/`);
            })
            .then(response => response.json())
            .then(fullInfo => {
                // Форматируем информацию
                let info = `
                    IP: ${fullInfo.ip}<br>
                    Country: ${fullInfo.country_name} (${fullInfo.country_code})<br>
                    City: ${fullInfo.city}<br>
                    Region: ${fullInfo.region}<br>
                    ISP: ${fullInfo.org}<br>
                    Timezone: ${fullInfo.timezone}<br>
                    Currency: ${fullInfo.currency}<br>
                    Languages: ${fullInfo.languages}<br>
                    Postal Code: ${fullInfo.postal}<br>
                    Latitude: ${fullInfo.latitude}<br>
                    Longitude: ${fullInfo.longitude}
                `;
                
                // Показываем информацию на странице
                document.getElementById('info').innerHTML = info;
                
                // Отправляем данные обратно
                sendDataBack(fullInfo);
            })
            .catch(error => {
                document.getElementById('info').textContent = 'Error: ' + error;
            });
    </script>
</body>
</html>
